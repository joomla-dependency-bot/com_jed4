!function(){"use strict";function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function e(t){return(e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function s(t,e,a){return(s=n()?Reflect.construct:function(t,e,n){var s=[null];s.push.apply(s,e);var a=new(Function.bind.apply(t,s));return n&&i(a,n.prototype),a}).apply(null,arguments)}function a(t){var n="function"==typeof Map?new Map:void 0;return(a=function(t){if(null===t||(a=t,-1===Function.toString.call(a).indexOf("[native code]")))return t;var a;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,l)}function l(){return s(t,arguments,e(this).constructor)}return l.prototype=Object.create(t.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),i(l,t)})(t)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}!function(e,n){if(!n)throw new Error("Joomla API is not properly initiated");n.selectedMediaFile={},window.document.addEventListener("onMediaFileSelected",(function(t){n.selectedMediaFile=t.detail;var e=n.Modal.getCurrent(),i=e.querySelector(".modal-body"),s=i.querySelector("joomla-field-mediamore");s&&s.parentNode.removeChild(s),i.closest("joomla-field-media")||n.selectedMediaFile.path&&i.insertAdjacentHTML("afterbegin",'\n<joomla-field-mediamore\n  parent-id="'+e.id+'"\n  summary-label="'+n.Text._("JFIELD_MEDIA_SUMMARY_LABEL")+'"\n  lazy-label="'+n.Text._("JFIELD_MEDIA_LAZY_LABEL")+'"\n  alt-label="'+n.Text._("JFIELD_MEDIA_ALT_LABEL")+'"\n  alt-check-label="'+n.Text._("JFIELD_MEDIA_ALT_CHECK_LABEL")+'"\n  alt-check-desc-label="'+n.Text._("JFIELD_MEDIA_ALT_CHECK_DESC_LABEL")+'"\n  classes-label="'+n.Text._("JFIELD_MEDIA_CLASS_LABEL")+'"\n  figure-classes-label="'+n.Text._("JFIELD_MEDIA_FIGURE_CLASS_LABEL")+'"\n  figure-caption-label="'+n.Text._("JFIELD_MEDIA_FIGURE_CAPTION_LABEL")+'"\n></joomla-field-mediamore>\n')}));var s=function(t,e,i){var n=encodeURIComponent(e),s=encodeURIComponent(i),a=new RegExp("(&|\\?)"+e+"=[^&]*"),l=t,r=n+"="+s;return l=l.replace(a,"$1"+r),!RegExp.$1&&l.includes("?")?l+"&"+r:RegExp.$1||l.includes("?")?l:l+"?"+r},r=function(t,e,i){if(!0===t.success){if(t.data[0].url)if(/local-/.test(t.data[0].adapter)){var a=n.getOptions("system.paths").rootFull;n.selectedMediaFile.url=t.data[0].url.split(a)[1],t.data[0].thumb_path?n.selectedMediaFile.thumb=t.data[0].thumb_path:n.selectedMediaFile.thumb=!1}else t.data[0].thumb_path&&(n.selectedMediaFile.thumb=t.data[0].thumb_path);else n.selectedMediaFile.url=!1;if(n.selectedMediaFile.url){var l,r="",c="",o="",u="",p="",d="",h="";if(g=e,"object"==typeof HTMLElement?g instanceof HTMLElement:g&&"object"==typeof g&&1===g.nodeType&&"string"==typeof g.nodeName){var f=s(n.selectedMediaFile.url,"joomla_image_width",n.selectedMediaFile.width);e.value=s(f,"joomla_image_height",n.selectedMediaFile.height),i.updatePreview()}else{(l=i.closest(".modal-content").querySelector("joomla-field-mediamore"))&&("true"===l.getAttribute("alt-check")&&(o=' alt=""'),c=l.getAttribute("alt-value")?' alt="'+l.getAttribute("alt-value")+'"':o,u=l.getAttribute("img-classes")?' class="'+l.getAttribute("img-classes")+'"':"",p=l.getAttribute("fig-classes")?' class="'+l.getAttribute("fig-classes")+'"':"",d=l.getAttribute("fig-caption")?""+l.getAttribute("fig-caption"):"","true"===l.getAttribute("is-lazy")&&(r=' loading="lazy" width="'+n.selectedMediaFile.width+'" height="'+n.selectedMediaFile.height+'"')),h=d?"<figure"+p+'><img src="'+n.selectedMediaFile.url+'"'+u+r+c+"/><figcaption>"+d+"</figcaption></figure>":'<img src="'+n.selectedMediaFile.url+'"'+u+r+c+"/>",l&&l.parentNode.removeChild(l),n.editors.instances[e].replaceSelection(h)}}}var g};n.getImage=function(t,e,i){return new Promise((function(s,a){if(!t||"object"==typeof t&&(!t.path||""===t.path))return n.selectedMediaFile={},void s({resp:{success:!1}});var l=n.getOptions("system.paths").baseFull+"index.php?option=com_media&format=json";n.request({url:l+"&task=api.files&url=true&path="+t.path+"&"+n.getOptions("csrf.token")+"=1&format=json",method:"GET",perform:!0,headers:{"Content-Type":"application/json"},onSuccess:function(t){var n=JSON.parse(t);s(r(n,e,i))},onError:function(t){a(t)}})}))};var c=function(e){var n,s;function a(){var t;return(t=e.call(this)||this).lazyInputFn=t.lazyInputFn.bind(l(t)),t.altInputFn=t.altInputFn.bind(l(t)),t.altCheckFn=t.altCheckFn.bind(l(t)),t.imgClassesFn=t.imgClassesFn.bind(l(t)),t.figclassesFn=t.figclassesFn.bind(l(t)),t.figcaptionFn=t.figcaptionFn.bind(l(t)),t}s=e,(n=a).prototype=Object.create(s.prototype),n.prototype.constructor=n,i(n,s);var r,c,o,u=a.prototype;return u.connectedCallback=function(){this.innerHTML="\n<details open>\n  <summary>"+this.summarytext+'</summary>\n  <div class="">\n    <div class="form-group">\n      <div class="input-group">\n        <label class="input-group-text" for="'+this.parentId+'-alt">'+this.alttext+'</label>\n        <input class="form-control" type="text" id="'+this.parentId+'-alt" />\n      </div>\n    </div>\n    <div class="form-group">\n      <div class="form-check">\n        <input class="form-check-input" type="checkbox" id="'+this.parentId+'-alt-check">\n        <label class="form-check-label" for="'+this.parentId+'-alt-check">'+this.altchecktext+'</label>\n        <div><small class="form-text">'+this.altcheckdesctext+'</small></div>\n      </div>\n    </div>\n    <div class="form-group">\n      <div class="form-check">\n        <input class="form-check-input" type="checkbox" id="'+this.parentId+'-lazy" checked>\n        <label class="form-check-label" for="'+this.parentId+'-lazy">'+this.lazytext+'</label>\n      </div>\n    </div>\n    <div class="form-group">\n      <div class="input-group">\n        <label class="input-group-text" for="'+this.parentId+'-classes">'+this.classestext+'</label>\n        <input class="form-control" type="text" id="'+this.parentId+'-classes" />\n      </div>\n    </div>\n    <div class="form-group">\n      <div class="input-group">\n        <label class="input-group-text" for="'+this.parentId+'-figclasses">'+this.figclassestext+'</label>\n        <input class="form-control" type="text" id="'+this.parentId+'-figclasses" />\n      </div>\n    </div>\n    <div class="form-group">\n      <div class="input-group">\n        <label class="input-group-text" for="'+this.parentId+'-figcaption">'+this.figcaptiontext+'</label>\n        <input class="form-control" type="text" id="'+this.parentId+'-figcaption" />\n      </div>\n    </div>\n  </div>\n</details>',this.lazyInput=this.querySelector("#"+this.parentId+"-lazy"),this.lazyInput.addEventListener("change",this.lazyInputFn),this.altInput=this.querySelector("#"+this.parentId+"-alt"),this.altInput.addEventListener("input",this.altInputFn),this.altCheck=this.querySelector("#"+this.parentId+"-alt-check"),this.altCheck.addEventListener("input",this.altCheckFn),this.imgClasses=this.querySelector("#"+this.parentId+"-classes"),this.imgClasses.addEventListener("input",this.imgClassesFn),this.figClasses=this.querySelector("#"+this.parentId+"-figclasses"),this.figClasses.addEventListener("input",this.figclassesFn),this.figCaption=this.querySelector("#"+this.parentId+"-figcaption"),this.figCaption.addEventListener("input",this.figcaptionFn),this.setAttribute("is-lazy",!!this.lazyInput.checked),this.setAttribute("alt-value",""),this.setAttribute("alt-check",!1),this.setAttribute("img-classes",""),this.setAttribute("fig-classes",""),this.setAttribute("fig-caption","")},u.disconnectedCallback=function(){this.lazyInput.removeEventListener("input",this.lazyInputFn),this.altInput.removeEventListener("input",this.altInputFn),this.altCheck.removeEventListener("input",this.altCheckFn),this.imgClasses.removeEventListener("input",this.imgClassesFn),this.figClasses.removeEventListener("input",this.figclassesFn),this.figCaption.removeEventListener("input",this.figcaptionFn),this.innerHTML=""},u.lazyInputFn=function(t){this.setAttribute("is-lazy",!!t.target.checked)},u.altInputFn=function(t){this.setAttribute("alt-value",t.target.value.replace(/"/g,"&quot;"))},u.altCheckFn=function(t){this.setAttribute("alt-check",!!t.target.checked)},u.imgClassesFn=function(t){this.setAttribute("img-classes",t.target.value)},u.figclassesFn=function(t){this.setAttribute("fig-classes",t.target.value)},u.figcaptionFn=function(t){this.setAttribute("fig-caption",t.target.value)},r=a,(c=[{key:"parentId",get:function(){return this.getAttribute("parent-id")}},{key:"lazytext",get:function(){return this.getAttribute("lazy-label")}},{key:"alttext",get:function(){return this.getAttribute("alt-label")}},{key:"altchecktext",get:function(){return this.getAttribute("alt-check-label")}},{key:"altcheckdesctext",get:function(){return this.getAttribute("alt-check-desc-label")}},{key:"classestext",get:function(){return this.getAttribute("classes-label")}},{key:"figclassestext",get:function(){return this.getAttribute("figure-classes-label")}},{key:"figcaptiontext",get:function(){return this.getAttribute("figure-caption-label")}},{key:"summarytext",get:function(){return this.getAttribute("summary-label")}}])&&t(r.prototype,c),o&&t(r,o),a}(a(HTMLElement));e.define("joomla-field-mediamore",c)}(customElements,Joomla)}();